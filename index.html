<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Open App</title>
    <script type="text/javascript">
        var appUrl = "iapdeeplink://";
        var appStoreUrl = "https://apps.apple.com/app/6473403510";

        // Function to try opening the app using window.location
        function tryOpenApp() {
            var now = Date.now();
            var hasFocus = true;

            // Event listener to detect if the user has left the page (i.e., the app was opened)
            window.onblur = function() {
                hasFocus = false;
            };

            // Attempt to open the deep link
            window.location = appUrl;

            // Check if the app was opened successfully after a delay
            setTimeout(function() {
                var later = Date.now();
                // If the time difference is less than 2 seconds and the page still has focus, it means the deep link failed to open
                if (later - now < 2000 && hasFocus) {
                    redirectToAppStore();
                }
            }, 1500); // Check slightly before the redirect time
        }

        // Function to redirect to App Store if the app can't be opened
        function redirectToAppStore() {
            window.location.href = appStoreUrl;
        }

        // Attempt to open the app on page load
        window.onload = tryOpenApp;
    </script>
</head>
<body>
    <!-- Optionally, you can add UI elements or messages here -->
</body>
</html>
